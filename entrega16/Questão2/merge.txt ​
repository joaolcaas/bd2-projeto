MERGE INTO dim_obj_tab_professor p
    USING dim_professor pt
    ON (p.id_professor = pt.id_professor)
  WHEN NOT MATCHED THEN
    INSERT VALUES (pt.id_professor,pt.nome);

MERGE INTO dim_obj_tab_disciplina d
    USING dim_disciplina dt
    ON (d.id_disciplina = dt.id_disciplina)
  WHEN NOT MATCHED THEN
    INSERT VALUES (dt.id_disciplina,
                    dt.nome,
                    dt.sigla,
                    dt.area,
                    dt.carga,
                    dt.creditos);

MERGE INTO dim_obj_tab_curso c
    USING dim_curso ct
    ON (c.id_curso = ct.id_curso)
  WHEN NOT MATCHED THEN
    INSERT VALUES (ct.id_curso,
                    ct.nome);

MERGE INTO dim_obj_tab_sala s
    USING dim_sala st
    ON (s.id_sala = st.id_sala)
  WHEN NOT MATCHED THEN
    INSERT VALUES (st.id_sala,
                    st.codigo,
                    st.capacidade);


--exemplo de insert

insert into fat_obj_tab_alocacao values((select ref(d) from dim_obj_tab_disciplina d where d.id_disciplina = 1),
                                        (select ref(p) from dim_obj_tab_professor p where p.id_professor = 1),
                                        (select ref(c) from dim_obj_tab_curso c where c.id_curso = 1),
                                        (select ref(t) from dim_obj_tab_sala t where t.id_sala = 1),1,'2014.2', 25, 7.87);
                                        
                                        
                                        
        
                                        
                                        
                                        
        